<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Lingua Teacher Manage System</title>
    </head>
    <body>
        이름:&nbsp;
        <input id="name" type="text" style="width:150px" onkeypress=enterTest()>
        <button onclick="search()" stype="width:50px">Search</button>
        <br>
        <br>

        부서:&nbsp;
        <input id="dept" type="text" style="width:50px">
        전화번호:&nbsp;
        <input id="contact" type="text" style="width:100px">
        성범죄확인:&nbsp;
        <input id="scrime" type="text" style="width:10px">
        교육청등록:&nbsp;
        <input id="reg" type="text" style="width:40px">
        <br>

        주소:&nbsp;
        <input id="addr" type="text" style="width:500px">
        <br>
        주민등록번호:&nbsp;
        <input id="nid" type="text" style="width:145px">
        계좌번호:&nbsp;
        <input id="account" type="text" style="width:200px">
        <br>
        기타사항:
        <br>
        <textarea id="memo" rows="5" name="memo" style="width:550px"></textarea>



        <script type="text/javascript">
            function enterTest() {
                // Function to check whether enter key is pressed inside "name" textbox
                // when enter key pressed, search teacher by the name
                if(window.event.keyCode == 13) {
                    search();
                }
            }

            function search() {
                // Function to search and retrieve proper teacher object
                
                // For dummy data
                let requestURL = "https://raw.githubusercontent.com/hyecheol123/Lingua_Teacher_Manage_Prototype/master/data.json"
                let request = new XMLHttpRequest();
                request.open('GET', requestURL);
                request.send();
                request.onreadystatechange = function() {
                    if(request.readyState === XMLHttpRequest.DONE) {
                        if(request.status == 200) {
                            // retrieve teacher information by name
                            let name = document.getElementById("name").value;
                            let teacher_list = JSON.parse(request.responseText);
                            let teacher = undefined;
                            for(let i = 0; i < teacher_list.length; i++) {
                                if(teacher_list[i].name == name) {
                                    teacher = teacher_list[i];
                                }
                            }

                            if(teacher == undefined) { // No teacher found with the name
                                alert("Not Existing Teacher: " + name);
                            } else {
                                // write data to the text box
                                document.getElementById("addr").value = teacher.addr;
                                document.getElementById("dept").value = teacher.dept;
                                if(teacher.nid == null) {
                                    document.getElementById("nid").value = "N/A";
                                } else {
                                    document.getElementById("nid").value = teacher.nid;
                                }
                                document.getElementById("contact").value = teacher.contact;
                                if(teacher.scrime == true) {
                                    document.getElementById("scrime").value = "O";
                                } else {
                                    document.getElementById("scrime").value = "X";
                                }
                                if(teacher.reg == false) {
                                    document.getElementById("reg").value = "X";
                                } else {
                                    document.getElementById("reg").value = teacher.reg;
                                }
                                document.getElementById("account").value = teacher.account;
                                document.getElementById("memo").value = teacher.memo;
                            }
                        } else {
                            alert("Fail to Connect DB");
                        }
                    }
                }
            }
      </script>
  </body>
</html>